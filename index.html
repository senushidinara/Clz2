<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroX - Cognitive Training Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            /* Pastel Tab Colors */
            --home-color: #A7C7E7;
            --dashboard-color: #B9E0D8;
            --challenges-color: #FBC4AB;
            --sleep-color: #EAD7D1;
            --focus-color: #FFF5BA;
            
            /* Base Colors */
            --white: #ffffff;
            --black: #2d2d2d;
            --gray-light: #f8f9fa;
            --gray-medium: #6c757d;
            --gray-dark: #495057;
            --shadow: rgba(0, 0, 0, 0.1);
            --shadow-light: rgba(0, 0, 0, 0.05);
            
            /* Gradients */
            --home-gradient: linear-gradient(135deg, #A7C7E7 0%, #9BB8E0 50%, #8FA9D9 100%);
            --dashboard-gradient: linear-gradient(135deg, #B9E0D8 0%, #A5D6CC 50%, #91CCC0 100%);
            --challenges-gradient: linear-gradient(135deg, #FBC4AB 0%, #F9B59F 50%, #F7A693 100%);
            --sleep-gradient: linear-gradient(135deg, #EAD7D1 0%, #E4CAC3 50%, #DEBDB5 100%);
            --focus-gradient: linear-gradient(135deg, #FFF5BA 0%, #FDEF9F 50%, #FBE984 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gray-light);
            color: var(--black);
            overflow-x: hidden;
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            transition: all 0.8s ease;
        }

        .bg-home { background: var(--home-gradient); animation: gradientShift 8s ease-in-out infinite; }
        .bg-dashboard { background: var(--dashboard-gradient); animation: gradientShift 8s ease-in-out infinite; }
        .bg-challenges { background: var(--challenges-gradient); animation: gradientShift 8s ease-in-out infinite; }
        .bg-sleep { background: var(--sleep-gradient); animation: gradientShift 8s ease-in-out infinite; }
        .bg-focus { background: var(--focus-gradient); animation: gradientShift 8s ease-in-out infinite; }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Top Navigation */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            box-shadow: 0 2px 20px var(--shadow-light);
            animation: fadeInDown 0.8s ease-out;
        }

        .logo {
            font-size: 2rem;
            font-weight: 800;
            color: var(--black);
            letter-spacing: -0.5px;
        }

        /* Main Content */
        .main-content {
            margin-top: 80px;
            margin-bottom: 100px;
            min-height: calc(100vh - 180px);
            padding: 2rem;
            animation: fadeInUp 0.8s ease-out;
        }

        /* Page Containers */
        .page {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeInUp 0.6s ease-out;
        }

        .page.active {
            display: block;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px var(--shadow);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px var(--shadow);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        /* Buttons */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            background: var(--white);
            color: var(--black);
            box-shadow: 0 2px 10px var(--shadow-light);
        }

        .btn:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 20px var(--shadow);
        }

        .btn:active {
            transform: translateY(0) scale(0.98);
        }

        .btn-primary {
            background: var(--home-color);
            color: var(--black);
        }

        .btn-dashboard {
            background: var(--dashboard-color);
            color: var(--black);
        }

        .btn-challenges {
            background: var(--challenges-color);
            color: var(--black);
        }

        .btn-sleep {
            background: var(--sleep-color);
            color: var(--black);
        }

        .btn-focus {
            background: var(--focus-color);
            color: var(--black);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 100;
            box-shadow: 0 -2px 20px var(--shadow-light);
            padding: 0 1rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .nav-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.8rem 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 70px;
            background: transparent;
            color: var(--gray-medium);
        }

        .nav-tab:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.8);
        }

        .nav-tab.active {
            animation: slideUp 0.4s ease-out;
            color: var(--white);
            transform: translateY(-5px);
        }

        .nav-tab.active.tab-home { background: var(--home-color); }
        .nav-tab.active.tab-dashboard { background: var(--dashboard-color); }
        .nav-tab.active.tab-challenges { background: var(--challenges-color); }
        .nav-tab.active.tab-sleep { background: var(--sleep-color); }
        .nav-tab.active.tab-focus { background: var(--focus-color); }

        .nav-tab i {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
            transition: all 0.3s ease;
        }

        .nav-tab span {
            font-size: 0.8rem;
            font-weight: 500;
        }

        .nav-tab:active i {
            animation: bounce 0.3s ease;
        }

        /* Video Background for Home */
        .video-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.4;
            z-index: -1;
        }

        .video-container {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        /* EEG Waveform Animation */
        .eeg-container {
            height: 200px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            margin: 1rem 0;
        }

        .eeg-wave {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--dashboard-color);
            animation: waveMove 2s linear infinite;
            transform-origin: left center;
        }

        .eeg-wave.growing {
            animation: waveGrow 3s ease-in-out, waveMove 2s linear infinite;
        }

        @keyframes waveMove {
            0% { transform: translateX(-100%) scaleY(1); }
            25% { transform: translateX(-50%) scaleY(2); }
            50% { transform: translateX(0%) scaleY(1.5); }
            75% { transform: translateX(50%) scaleY(3); }
            100% { transform: translateX(100%) scaleY(1); }
        }

        @keyframes waveGrow {
            0% { transform: scaleY(1); }
            50% { transform: scaleY(4); }
            100% { transform: scaleY(2); }
        }

        /* Sleep Animation */
        .sleep-scene {
            position: relative;
            height: 200px;
            background: linear-gradient(to bottom, #2c3e50 0%, #34495e 100%);
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .moon {
            position: absolute;
            top: 20px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #f4f4f4;
            border-radius: 50%;
            animation: moonGlow 4s ease-in-out infinite;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s ease-in-out infinite;
        }

        .star:nth-child(2) { top: 30px; left: 50px; width: 3px; height: 3px; animation-delay: 0.5s; }
        .star:nth-child(3) { top: 60px; left: 150px; width: 2px; height: 2px; animation-delay: 1s; }
        .star:nth-child(4) { top: 40px; left: 250px; width: 4px; height: 4px; animation-delay: 1.5s; }
        .star:nth-child(5) { top: 80px; left: 100px; width: 2px; height: 2px; animation-delay: 2s; }

        @keyframes moonGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(244, 244, 244, 0.5); }
            50% { box-shadow: 0 0 20px rgba(244, 244, 244, 0.8); }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Focus Timer */
        .timer-circle {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 2rem auto;
        }

        .timer-circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .timer-circle circle {
            fill: none;
            stroke-width: 8;
        }

        .timer-bg {
            stroke: rgba(0, 0, 0, 0.1);
        }

        .timer-progress {
            stroke: var(--focus-color);
            stroke-linecap: round;
            transition: stroke-dashoffset 1s linear;
        }

        .timer-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: 700;
            color: var(--black);
        }

        /* Progress Bars */
        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 6px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--challenges-color), var(--focus-color));
            border-radius: 6px;
            transition: width 0.3s ease;
        }

        .progress-fill.animated {
            animation: progressFill 5s ease-in-out;
        }

        @keyframes progressFill {
            0% { width: 0%; }
            100% { width: var(--target-width, 100%); }
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideInFromBottom 0.4s ease;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-medium);
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--black);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 100px;
            right: 2rem;
            background: var(--challenges-color);
            color: var(--black);
            padding: 1rem 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px var(--shadow);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1001;
        }

        .toast.show {
            transform: translateX(0);
        }

        /* Charts Placeholder */
        .chart-placeholder {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.1) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-medium);
            font-weight: 500;
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
        }

        .chart-placeholder::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--challenges-color);
            animation: confettiFall 3s linear infinite;
            z-index: 999;
        }

        .confetti:nth-child(odd) { background: var(--focus-color); }
        .confetti:nth-child(3n) { background: var(--dashboard-color); }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { transform: translateY(10px); }
            to { transform: translateY(-5px); }
        }

        @keyframes slideInFromBottom {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }

            .card-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .nav-tab {
                padding: 0.6rem 0.8rem;
                min-width: 60px;
            }

            .nav-tab i {
                font-size: 1.2rem;
            }

            .nav-tab span {
                font-size: 0.7rem;
            }

            .timer-circle {
                width: 150px;
                height: 150px;
            }

            .timer-text {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 1.5rem;
            }

            .card {
                padding: 1.5rem;
            }

            .nav-tab span {
                display: none;
            }

            .bottom-nav {
                height: 80px;
            }

            .main-content {
                margin-bottom: 80px;
            }
        }

        /* Specific Page Styles */
        .hero-section {
            text-align: center;
            padding: 3rem 0;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            color: var(--black);
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: var(--gray-medium);
            margin-bottom: 2rem;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 10px var(--shadow-light);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--black);
        }

        .stat-label {
            color: var(--gray-medium);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .challenge-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .challenge-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px var(--shadow);
        }

        .challenge-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .challenge-description {
            color: var(--gray-medium);
            margin-bottom: 1rem;
        }

        .quote-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            margin: 2rem 0;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quote-text {
            font-size: 1.1rem;
            font-style: italic;
            color: var(--gray-dark);
            animation: fadeIn 1s ease;
        }

        /* Sleep Score Display */
        .sleep-score {
            text-align: center;
            padding: 2rem;
        }

        .score-circle {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto 1rem;
        }

        .score-circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .score-circle circle {
            fill: none;
            stroke-width: 10;
        }

        .score-bg {
            stroke: rgba(0, 0, 0, 0.1);
        }

        .score-progress {
            stroke: var(--sleep-color);
            stroke-linecap: round;
            transition: stroke-dashoffset 2s ease;
        }

        .score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: 700;
            color: var(--black);
        }

        /* Letter by letter animation */
        .typewriter {
            overflow: hidden;
            border-right: 2px solid var(--black);
            white-space: nowrap;
            animation: typewriter 3s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: var(--black); }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg bg-home" id="animatedBg"></div>

    <!-- Top Navigation -->
    <div class="top-nav">
        <div class="logo">NeuroX</div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Home Page -->
        <div class="page active" id="home">
            <div class="video-container">
                <div class="video-bg" style="background: radial-gradient(circle, rgba(167,199,231,0.3) 0%, rgba(155,184,224,0.2) 100%); position: relative;">
                    <!-- Simulated neurons -->
                    <div style="position: absolute; top: 20%; left: 10%; width: 4px; height: 4px; background: white; border-radius: 50%; animation: twinkle 1.5s infinite;"></div>
                    <div style="position: absolute; top: 60%; left: 30%; width: 3px; height: 3px; background: white; border-radius: 50%; animation: twinkle 2s infinite; animation-delay: 0.5s;"></div>
                    <div style="position: absolute; top: 40%; left: 70%; width: 5px; height: 5px; background: white; border-radius: 50%; animation: twinkle 1.8s infinite; animation-delay: 1s;"></div>
                    <div style="position: absolute; top: 80%; left: 50%; width: 4px; height: 4px; background: white; border-radius: 50%; animation: twinkle 2.2s infinite; animation-delay: 1.5s;"></div>
                </div>
            </div>

            <div class="hero-section">
                <h1 class="hero-title">Welcome to NeuroX</h1>
                <p class="hero-subtitle">Advanced cognitive training for peak mental performance</p>
                
                <div class="quick-actions">
                    <button class="btn btn-dashboard" onclick="navigateToPage('dashboard')">
                        <i class="fas fa-brain"></i>
                        Start Brain Dashboard
                    </button>
                    <button class="btn btn-sleep" onclick="navigateToPage('sleep')">
                        <i class="fas fa-moon"></i>
                        Improve Sleep
                    </button>
                    <button class="btn btn-challenges" onclick="navigateToPage('challenges')">
                        <i class="fas fa-trophy"></i>
                        Daily Challenge
                    </button>
                </div>
            </div>

            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-number">87</div>
                    <div class="stat-label">Cognitive Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15</div>
                    <div class="stat-label">Days Streak</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">42</div>
                    <div class="stat-label">Sessions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">Pro</div>
                    <div class="stat-label">Level</div>
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <div class="page" id="dashboard">
            <div class="card">
                <h2>Brain Activity Monitor</h2>
                <div class="eeg-container" id="eegContainer">
                    <div class="eeg-wave"></div>
                </div>
                <button class="btn btn-dashboard" onclick="startBrainScan()">
                    <i class="fas fa-play"></i>
                    Start Brain Scan
                </button>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h3>Memory Improvement Over Time</h3>
                    <div class="chart-placeholder">
                        <i class="fas fa-chart-line" style="font-size: 2rem; margin-right: 1rem;"></i>
                        Interactive Chart Loading...
                    </div>
                </div>
                <div class="card">
                    <h3>Focus Levels Today</h3>
                    <div class="chart-placeholder">
                        <i class="fas fa-chart-bar" style="font-size: 2rem; margin-right: 1rem;"></i>
                        Real-time Data Updating...
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Interactive Brain Diagram</h3>
                <div style="text-align: center; padding: 2rem;">
                    <div style="position: relative; display: inline-block;">
                        <div style="width: 200px; height: 150px; background: linear-gradient(135deg, var(--dashboard-color), rgba(185,224,216,0.7)); border-radius: 50% 50% 45% 45%; margin: 0 auto; position: relative; cursor: pointer;" onclick="showBrainInfo('memory')">
                            <div style="position: absolute; top: 30%; left: 20%; background: rgba(255,255,255,0.8); padding: 0.5rem; border-radius: 8px; font-size: 0.8rem; font-weight: 600; cursor: pointer;" onclick="showBrainInfo('memory')">Memory</div>
                            <div style="position: absolute; top: 20%; right: 20%; background: rgba(255,255,255,0.8); padding: 0.5rem; border-radius: 8px; font-size: 0.8rem; font-weight: 600; cursor: pointer;" onclick="showBrainInfo('focus')">Focus</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Challenges Page -->
        <div class="page" id="challenges">
            <div class="card">
                <h2>Neuro Challenges</h2>
                <p>Test your cognitive abilities with these engaging challenges</p>
            </div>

            <div class="challenge-card" onclick="openChallenge('memory')">
                <div class="challenge-title">Memory Match Challenge</div>
                <div class="challenge-description">Test your working memory with pattern matching</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 65%;"></div>
                </div>
                <small>Progress: 65% Complete</small>
            </div>

            <div class="challenge-card" onclick="openChallenge('speed')">
                <div class="challenge-title">Speed Processing</div>
                <div class="challenge-description">React quickly to visual stimuli</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 40%;"></div>
                </div>
                <small>Progress: 40% Complete</small>
            </div>

            <div class="challenge-card" onclick="openChallenge('logic')">
                <div class="challenge-title">Logic Puzzles</div>
                <div class="challenge-description">Solve complex reasoning problems</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 80%;"></div>
                </div>
                <small>Progress: 80% Complete</small>
            </div>

            <div class="card">
                <h3>Leaderboard</h3>
                <button class="btn btn-challenges" onclick="showLeaderboard()">
                    <i class="fas fa-trophy"></i>
                    View Leaderboard
                </button>
                <button class="btn btn-primary" onclick="joinChallenge()">
                    <i class="fas fa-plus"></i>
                    Join Challenge
                </button>
            </div>
        </div>

        <!-- Sleep Page -->
        <div class="page" id="sleep">
            <div class="card">
                <h2>Sleep & Recovery</h2>
                <div class="sleep-scene">
                    <div class="moon"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                </div>
            </div>

            <div class="card">
                <div class="sleep-score">
                    <h3>Last Night's Sleep Score</h3>
                    <div class="score-circle">
                        <svg>
                            <circle cx="75" cy="75" r="65" class="score-bg" stroke-dasharray="408" stroke-dashoffset="0"></circle>
                            <circle cx="75" cy="75" r="65" class="score-progress" stroke-dasharray="408" stroke-dashoffset="53" id="sleepScoreCircle"></circle>
                        </svg>
                        <div class="score-text" id="sleepScoreText">87/100</div>
                    </div>
                </div>
                <button class="btn btn-sleep" onclick="trackSleep()">
                    <i class="fas fa-moon"></i>
                    Track Sleep Now
                </button>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h3>Sleep Stages</h3>
                    <div class="chart-placeholder">
                        <i class="fas fa-chart-pie" style="font-size: 2rem; margin-right: 1rem;"></i>
                        Hypnogram Chart
                    </div>
                </div>
                <div class="card">
                    <h3>Sleep Tips</h3>
                    <div style="cursor: pointer;" onclick="expandSleepTips()">
                        <p><i class="fas fa-lightbulb"></i> Click to view personalized sleep tips</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Sleep History</h3>
                <button class="btn btn-sleep" onclick="viewSleepHistory()">
                    <i class="fas fa-history"></i>
                    View Sleep History
                </button>
            </div>
        </div>

        <!-- Focus Page -->
        <div class="page" id="focus">
            <div class="card">
                <h2>Guided Focus Sessions</h2>
                <div style="position: relative; height: 200px; background: linear-gradient(135deg, rgba(255,245,186,0.3) 0%, rgba(251,233,132,0.2) 100%); border-radius: 12px; overflow: hidden;">
                    <!-- Video placeholder with moving gradients -->
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%); animation: gradientMove 3s ease-in-out infinite;"></div>
                </div>
            </div>

            <div class="card">
                <h3>Pomodoro Timer</h3>
                <div class="timer-circle">
                    <svg>
                        <circle cx="100" cy="100" r="90" class="timer-bg" stroke-dasharray="565" stroke-dashoffset="0"></circle>
                        <circle cx="100" cy="100" r="90" class="timer-progress" stroke-dasharray="565" stroke-dashoffset="565" id="timerProgress"></circle>
                    </svg>
                    <div class="timer-text" id="timerText">25:00</div>
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-focus" onclick="startFocusSession()">
                        <i class="fas fa-play"></i>
                        Begin Focus Session
                    </button>
                </div>
            </div>

            <div class="card-grid">
                <div class="card" onclick="selectFocusMode('deep')">
                    <h4>Deep Work</h4>
                    <p>Intensive 50-minute sessions for complex tasks</p>
                </div>
                <div class="card" onclick="selectFocusMode('light')">
                    <h4>Light Focus</h4>
                    <p>25-minute sessions for routine activities</p>
                </div>
                <div class="card" onclick="selectFocusMode('relax')">
                    <h4>Relax Mode</h4>
                    <p>Gentle background ambience for calm focus</p>
                </div>
            </div>

            <div class="quote-container">
                <div class="quote-text" id="motivationalQuote">
                    "The successful warrior is the average person with laser-like focus."
                </div>
            </div>

            <div class="card">
                <h3>Current Streak</h3>
                <div style="text-align: center;">
                    <div style="font-size: 3rem; font-weight: 700; color: var(--focus-color); text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">5</div>
                    <div style="color: var(--gray-medium);">Days of consistent focus training</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-tab active tab-home" onclick="navigateToPage('home')" data-page="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="nav-tab tab-dashboard" onclick="navigateToPage('dashboard')" data-page="dashboard">
            <i class="fas fa-brain"></i>
            <span>Dashboard</span>
        </div>
        <div class="nav-tab tab-challenges" onclick="navigateToPage('challenges')" data-page="challenges">
            <i class="fas fa-trophy"></i>
            <span>Challenges</span>
        </div>
        <div class="nav-tab tab-sleep" onclick="navigateToPage('sleep')" data-page="sleep">
            <i class="fas fa-moon"></i>
            <span>Sleep</span>
        </div>
        <div class="nav-tab tab-focus" onclick="navigateToPage('focus')" data-page="focus">
            <i class="fas fa-bullseye"></i>
            <span>Focus</span>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="brainScanModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('brainScanModal')">&times;</button>
            <h3>Brain Scan Analysis</h3>
            <div class="eeg-container">
                <div class="eeg-wave growing"></div>
            </div>
            <div id="analysisText" class="typewriter" style="margin-top: 1rem;">
                Analyzing neural patterns...
            </div>
        </div>
    </div>

    <div class="modal" id="challengeModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('challengeModal')">&times;</button>
            <h3 id="challengeTitle">Challenge Rules</h3>
            <div id="challengeContent">
                <p>Complete the memory sequence as quickly as possible. You'll see a pattern of lights - repeat the sequence in the same order.</p>
                <div style="margin: 2rem 0;">
                    <strong>Instructions:</strong>
                    <ul style="margin-left: 2rem; margin-top: 1rem;">
                        <li>Watch the sequence carefully</li>
                        <li>Wait for the "GO" signal</li>
                        <li>Click the squares in the same order</li>
                        <li>Try to beat your best time!</li>
                    </ul>
                </div>
                <button class="btn btn-challenges" onclick="startChallenge()">
                    <i class="fas fa-play"></i>
                    Start Challenge
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="leaderboardModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('leaderboardModal')">&times;</button>
            <h3>Global Leaderboard</h3>
            <div style="margin: 1rem 0;">
                <div style="display: flex; justify-content: space-between; padding: 1rem; background: var(--challenges-color); border-radius: 8px; margin-bottom: 0.5rem;">
                    <span><i class="fas fa-trophy" style="color: gold;"></i> Alex_Neuro</span>
                    <span>2,847 pts</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 1rem; background: rgba(0,0,0,0.05); border-radius: 8px; margin-bottom: 0.5rem;">
                    <span><i class="fas fa-medal" style="color: silver;"></i> BrainMaster</span>
                    <span>2,634 pts</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 1rem; background: rgba(0,0,0,0.05); border-radius: 8px; margin-bottom: 0.5rem;">
                    <span><i class="fas fa-medal" style="color: #cd7f32;"></i> NeuroNinja</span>
                    <span>2,521 pts</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 1rem; background: var(--focus-color); border-radius: 8px; margin-bottom: 0.5rem;">
                    <span><strong>You</strong></span>
                    <span><strong>2,340 pts</strong></span>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="sleepHistoryModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('sleepHistoryModal')">&times;</button>
            <h3>Sleep History</h3>
            <div class="chart-placeholder" style="height: 250px;">
                <i class="fas fa-chart-area" style="font-size: 2rem; margin-right: 1rem;"></i>
                7-Day Sleep Pattern Analysis
            </div>
            <div style="margin-top: 1rem;">
                <p><strong>Average Sleep Duration:</strong> 7.5 hours</p>
                <p><strong>Sleep Efficiency:</strong> 89%</p>
                <p><strong>Best Night:</strong> Tuesday (9.2 hours)</p>
            </div>
        </div>
    </div>

    <div class="modal" id="brainInfoModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('brainInfoModal')">&times;</button>
            <h3 id="brainRegionTitle">Brain Region</h3>
            <div id="brainRegionContent">
                Information about the selected brain region will appear here.
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">Challenge Joined!</div>

    <script>
        // Application State
        let activeTab = 'home';
        let focusTimer = null;
        let focusTime = 25 * 60; // 25 minutes in seconds
        let isTimerRunning = false;
        let quoteInterval = null;

        // Make functions immediately available
        window.navigateToPage = function(page) {
            console.log('üîÑ Navigating to:', page);
            try {
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));

                const targetTab = document.querySelector(`.nav-tab[data-page="${page}"]`);
                const targetPage = document.getElementById(page);

                if (targetTab && targetPage) {
                    targetTab.classList.add('active');
                    targetPage.classList.add('active');

                    const bg = document.getElementById('animatedBg');
                    if (bg) bg.className = `animated-bg bg-${page}`;

                    activeTab = page;
                    showToast(`üì± Switched to ${page.charAt(0).toUpperCase() + page.slice(1)}`);
                }
            } catch (error) {
                console.error('Navigation error:', error);
            }
        };

        window.openChallenge = function(type) {
            console.log('üéÆ Opening challenge:', type);
            try {
                const modal = document.getElementById('challengeModal');
                const title = document.getElementById('challengeTitle');
                const content = document.getElementById('challengeContent');

                if (!modal || !title || !content) {
                    console.error('Challenge modal elements not found');
                    showToast('‚ùå Challenge not available');
                    return;
                }

                const challenges = {
                    memory: {
                        title: "üß† Memory Match Challenge",
                        description: "Test your working memory with sequence matching"
                    },
                    speed: {
                        title: "‚ö° Speed Processing Challenge",
                        description: "React quickly to visual stimuli"
                    },
                    logic: {
                        title: "üß© Logic Puzzle Challenge",
                        description: "Solve complex reasoning problems"
                    }
                };

                const challenge = challenges[type] || challenges.memory;
                title.textContent = challenge.title;
                content.innerHTML = `
                    <p style="font-size: 1.1rem; margin-bottom: 2rem;">${challenge.description}</p>
                    <div style="background: rgba(0,0,0,0.05); padding: 1.5rem; border-radius: 12px; margin: 1.5rem 0;">
                        <strong>üìã How to Play:</strong>
                        <ul style="margin: 1rem 0; padding-left: 1.5rem; line-height: 1.6;">
                            <li>Focus and concentrate on the task</li>
                            <li>Try to beat your previous score</li>
                            <li>Track your improvement over time</li>
                            <li>Challenge yourself daily for best results</li>
                        </ul>
                    </div>
                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn btn-challenges" onclick="startChallenge('${type}')" style="padding: 1rem 2rem; font-size: 1.1rem;">
                            <i class="fas fa-play"></i>
                            Start Challenge
                        </button>
                    </div>
                `;

                modal.classList.add('active');
                showToast(`üéÆ ${challenge.title} opened!`);
                console.log('‚úÖ Challenge modal opened successfully for:', type);
            } catch (error) {
                console.error('Open challenge error:', error);
                showToast('‚ùå Error opening challenge');
            }
        };

        window.startChallenge = function(type) {
            console.log('üöÄ Starting challenge:', type);
            try {
                closeModal('challengeModal');

                const messages = {
                    memory: "üß† Memory Challenge Started! Watch the patterns carefully!",
                    speed: "‚ö° Speed Challenge Started! React as fast as you can!",
                    logic: "üß© Logic Challenge Started! Use your reasoning skills!"
                };

                showToast(messages[type] || "üéÆ Challenge Started! Good luck!");

                // Simulate challenge progress after 3 seconds
                setTimeout(() => {
                    createConfetti();
                    showToast("üèÜ Challenge completed! Great job!");

                    // Update progress bar
                    setTimeout(() => {
                        const progressBars = document.querySelectorAll('#challenges .progress-fill');
                        if (progressBars.length > 0) {
                            const randomBar = progressBars[Math.floor(Math.random() * progressBars.length)];
                            const currentWidth = parseInt(randomBar.style.width) || 0;
                            const newWidth = Math.min(100, currentWidth + 15);
                            randomBar.style.width = newWidth + '%';

                            const progressText = randomBar.closest('.challenge-card').querySelector('small');
                            if (progressText) {
                                progressText.textContent = `Progress: ${newWidth}% Complete`;
                            }
                        }
                    }, 1000);
                }, 3000);

                console.log('‚úÖ Challenge started successfully');
            } catch (error) {
                console.error('Start challenge error:', error);
                showToast('‚ùå Error starting challenge');
            }
        };

        window.joinChallenge = function() {
            console.log('üéâ Joining challenge...');
            try {
                createConfetti();
                showToast("üéâ Challenge Joined Successfully!");

                setTimeout(() => {
                    const progressBars = document.querySelectorAll('#challenges .progress-fill');
                    if (progressBars.length > 0) {
                        const randomBar = progressBars[Math.floor(Math.random() * progressBars.length)];
                        const currentWidth = parseInt(randomBar.style.width) || 0;
                        const newWidth = Math.min(100, currentWidth + 10);
                        randomBar.style.width = newWidth + '%';

                        const progressText = randomBar.closest('.challenge-card').querySelector('small');
                        if (progressText) {
                            progressText.textContent = `Progress: ${newWidth}% Complete`;
                        }
                        showToast("üìà Progress updated!");
                    }
                }, 2000);

                console.log('‚úÖ Challenge joined successfully');
            } catch (error) {
                console.error('Join challenge error:', error);
                showToast('‚ùå Error joining challenge');
            }
        };

        window.showLeaderboard = function() {
            console.log('üèÜ Showing leaderboard...');
            try {
                const modal = document.getElementById('leaderboardModal');
                if (modal) {
                    modal.classList.add('active');
                    showToast("üèÜ Leaderboard loaded!");
                    console.log('‚úÖ Leaderboard modal opened');
                } else {
                    console.error('Leaderboard modal not found');
                    showToast('‚ùå Leaderboard not available');
                }
            } catch (error) {
                console.error('Leaderboard error:', error);
                showToast('‚ùå Error showing leaderboard');
            }
        };

        window.closeModal = function(modalId) {
            console.log('‚ùå Closing modal:', modalId);
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('active');
                    console.log('‚úÖ Modal closed:', modalId);
                } else {
                    console.error('Modal not found:', modalId);
                }
            } catch (error) {
                console.error('Close modal error:', error);
            }
        };

        window.showToast = function(message) {
            console.log('üçû Toast:', message);
            try {
                let toast = document.getElementById('toast');
                if (!toast) {
                    // Create toast if it doesn't exist
                    toast = document.createElement('div');
                    toast.id = 'toast';
                    toast.className = 'toast';
                    document.body.appendChild(toast);
                }

                toast.textContent = message;
                toast.classList.add('show');

                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);

            } catch (error) {
                console.error('Toast error:', error);
                alert(message); // Fallback
            }
        };

        window.createConfetti = function() {
            console.log('üéä Creating confetti...');
            try {
                for (let i = 0; i < 50; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.animationDelay = Math.random() * 3 + 's';
                        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';

                        const colors = ['#FBC4AB', '#A7C7E7', '#B9E0D8', '#EAD7D1', '#FFF5BA'];
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];

                        document.body.appendChild(confetti);

                        setTimeout(() => {
                            if (confetti.parentNode) {
                                confetti.remove();
                            }
                        }, 5000);
                    }, i * 50);
                }
            } catch (error) {
                console.error('Confetti error:', error);
            }
        };

        // ============ NAVIGATION FUNCTIONS ============
        function navigateToPage(page) {
            console.log('Navigating to:', page);

            try {
                // Remove active class from all tabs and pages
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));

                // Add active class to selected tab and page
                const targetTab = document.querySelector(`.nav-tab[data-page="${page}"]`);
                const targetPage = document.getElementById(page);

                if (targetTab && targetPage) {
                    targetTab.classList.add('active');
                    targetPage.classList.add('active');

                    // Update background
                    const bg = document.getElementById('animatedBg');
                    if (bg) {
                        bg.className = `animated-bg bg-${page}`;
                    }

                    activeTab = page;

                    // Page-specific initializations
                    if (page === 'focus') {
                        startQuoteRotation();
                    }

                    showToast(`Switched to ${page.charAt(0).toUpperCase() + page.slice(1)} page`);
                    console.log('Navigation successful to:', page);
                } else {
                    console.error('Navigation failed - elements not found for:', page);
                }
            } catch (error) {
                console.error('Navigation error:', error);
            }
        }

        // ============ DASHBOARD FUNCTIONS ============
        function startBrainScan() {
            console.log('Starting brain scan...');
            try {
                const modal = document.getElementById('brainScanModal');
                if (modal) {
                    modal.classList.add('active');

                    // Animate the EEG wave
                    const waves = modal.querySelectorAll('.eeg-wave');
                    waves.forEach(wave => wave.classList.add('growing'));

                    // Show immediate feedback
                    showToast("Brain scan initiated!");

                    // Simulate analysis text appearing letter by letter
                    setTimeout(() => {
                        const analysisText = document.getElementById('analysisText');
                        if (analysisText) {
                            const messages = [
                                "Analyzing neural patterns...",
                                "Detecting theta waves in hippocampus...",
                                "Measuring prefrontal cortex activity...",
                                "Analysis complete: Optimal cognitive state detected!"
                            ];

                            let messageIndex = 0;
                            const showNextMessage = () => {
                                if (messageIndex < messages.length) {
                                    analysisText.textContent = messages[messageIndex];
                                    analysisText.style.width = '0';
                                    analysisText.style.animation = 'none';
                                    setTimeout(() => {
                                        analysisText.style.animation = 'typewriter 2s steps(40, end)';
                                        analysisText.style.width = '100%';
                                    }, 100);
                                    messageIndex++;
                                    setTimeout(showNextMessage, 2500);
                                }
                            };
                            showNextMessage();
                        }
                    }, 500);
                    console.log('Brain scan modal opened');
                } else {
                    console.error('Brain scan modal not found');
                    showToast("Error: Brain scan modal not available");
                }
            } catch (error) {
                console.error('Brain scan error:', error);
                showToast("Error starting brain scan");
            }
        }

        function showBrainInfo(region) {
            console.log('Showing brain info for:', region);
            try {
                const modal = document.getElementById('brainInfoModal');
                const title = document.getElementById('brainRegionTitle');
                const content = document.getElementById('brainRegionContent');

                if (modal && title && content) {
                    const regions = {
                        memory: {
                            title: "Hippocampus - Memory Center",
                            content: `
                                <p>The hippocampus is crucial for forming new memories and learning. Located in the temporal lobe, it acts as a temporary storage area before information is transferred to long-term memory in the cortex.</p>
                                <h4>Key Functions:</h4>
                                <ul>
                                    <li>Formation of new memories</li>
                                    <li>Spatial navigation</li>
                                    <li>Learning and pattern recognition</li>
                                </ul>
                                <p><strong>Training Tip:</strong> Memory exercises and spatial puzzles can help strengthen hippocampal function.</p>
                            `
                        },
                        focus: {
                            title: "Prefrontal Cortex - Executive Control",
                            content: `
                                <p>The prefrontal cortex is responsible for executive functions including attention, decision-making, and working memory. It's often called the brain's "CEO".</p>
                                <h4>Key Functions:</h4>
                                <ul>
                                    <li>Sustained attention and focus</li>
                                    <li>Working memory</li>
                                    <li>Decision-making and planning</li>
                                    <li>Impulse control</li>
                                </ul>
                                <p><strong>Training Tip:</strong> Meditation, focus exercises, and cognitive training can enhance prefrontal cortex function.</p>
                            `
                        }
                    };

                    const regionInfo = regions[region] || regions.memory;
                    title.textContent = regionInfo.title;
                    content.innerHTML = regionInfo.content;
                    modal.classList.add('active');
                    showToast(`Learning about ${regionInfo.title}`);
                    console.log('Brain info modal opened for:', region);
                } else {
                    console.error('Brain info modal elements not found');
                    showToast("Error: Brain info not available");
                }
            } catch (error) {
                console.error('Brain info error:', error);
                showToast("Error showing brain information");
            }
        }

        // ============ CHALLENGE FUNCTIONS ============
        function joinChallenge() {
            console.log('Joining challenge...');
            try {
                createConfetti();
                showToast("üéâ Challenge Joined Successfully!");

                // Update progress on a random challenge
                setTimeout(() => {
                    const progressBars = document.querySelectorAll('#challenges .progress-fill');
                    if (progressBars.length > 0) {
                        const randomBar = progressBars[Math.floor(Math.random() * progressBars.length)];
                        const currentWidth = parseInt(randomBar.style.width) || 0;
                        const newWidth = Math.min(100, currentWidth + 10);
                        randomBar.style.width = newWidth + '%';

                        const progressText = randomBar.closest('.challenge-card').querySelector('small');
                        if (progressText) {
                            progressText.textContent = `Progress: ${newWidth}% Complete`;
                        }
                    }
                }, 1000);

                console.log('Challenge joined successfully');
            } catch (error) {
                console.error('Join challenge error:', error);
                showToast("Error joining challenge");
            }
        }

        function openChallenge(type) {
            console.log('Opening challenge:', type);
            try {
                const modal = document.getElementById('challengeModal');
                const title = document.getElementById('challengeTitle');
                const content = document.getElementById('challengeContent');

                if (modal && title && content) {
                    const challenges = {
                        memory: {
                            title: "üß† Memory Match Challenge",
                            content: "Test your working memory by matching sequences of patterns. Watch the sequence, then repeat it in the same order.",
                            instructions: [
                                "Watch the pattern sequence carefully",
                                "Wait for the sequence to complete",
                                "Click the squares in the same order",
                                "Try to beat your previous score!"
                            ]
                        },
                        speed: {
                            title: "‚ö° Speed Processing Challenge",
                            content: "React as quickly as possible to visual stimuli. The faster and more accurate you are, the higher your score.",
                            instructions: [
                                "Click targets as quickly as they appear",
                                "Accuracy is as important as speed",
                                "Avoid clicking false targets",
                                "Improve your reaction time!"
                            ]
                        },
                        logic: {
                            title: "üß© Logic Puzzle Challenge",
                            content: "Solve complex reasoning problems using deductive logic. Each puzzle builds on the previous one.",
                            instructions: [
                                "Read each puzzle carefully",
                                "Use logical reasoning to solve",
                                "Look for patterns and connections",
                                "Progress through increasing difficulty!"
                            ]
                        }
                    };

                    const challenge = challenges[type] || challenges.memory;
                    title.textContent = challenge.title;
                    content.innerHTML = `
                        <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">${challenge.content}</p>
                        <div style="background: rgba(0,0,0,0.05); padding: 1.5rem; border-radius: 12px; margin: 1.5rem 0;">
                            <strong>üìã How to Play:</strong>
                            <ul style="margin: 1rem 0; padding-left: 1.5rem;">
                                ${challenge.instructions.map(instruction => `<li style="margin: 0.5rem 0;">${instruction}</li>`).join('')}
                            </ul>
                        </div>
                        <div style="text-align: center; margin-top: 2rem;">
                            <button class="btn btn-challenges" onclick="startChallenge('${type}')" style="padding: 1rem 2rem; font-size: 1.1rem;">
                                <i class="fas fa-play"></i>
                                Start ${challenge.title.replace(/[üß†‚ö°üß©]/g, '').trim()}
                            </button>
                        </div>
                    `;

                    modal.classList.add('active');
                    showToast(`Opening ${challenge.title.replace(/[üß†‚ö°üß©]/g, '').trim()}`);
                    console.log('Challenge modal opened for:', type);
                } else {
                    console.error('Challenge modal elements not found');
                    showToast("Error: Challenge not available");
                }
            } catch (error) {
                console.error('Open challenge error:', error);
                showToast("Error opening challenge");
            }
        }

        // ============ UTILITY FUNCTIONS ============
        function showToast(message) {
            console.log('Showing toast:', message);
            try {
                const toast = document.getElementById('toast');
                if (toast) {
                    toast.textContent = message;
                    toast.classList.add('show');
                    setTimeout(() => {
                        toast.classList.remove('show');
                    }, 3000);
                } else {
                    console.error('Toast element not found');
                    // Fallback: create temporary toast
                    const tempToast = document.createElement('div');
                    tempToast.style.cssText = `
                        position: fixed;
                        top: 100px;
                        right: 2rem;
                        background: var(--challenges-color);
                        color: var(--black);
                        padding: 1rem 2rem;
                        border-radius: 12px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                        z-index: 1001;
                        animation: slideInFromRight 0.3s ease;
                    `;
                    tempToast.textContent = message;
                    document.body.appendChild(tempToast);

                    setTimeout(() => {
                        if (tempToast.parentNode) {
                            tempToast.remove();
                        }
                    }, 3000);
                }
            } catch (error) {
                console.error('Toast error:', error);
                alert(message); // Ultimate fallback
            }
        }

        function closeModal(modalId) {
            console.log('Closing modal:', modalId);
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('active');
                    console.log('Modal closed:', modalId);
                } else {
                    console.error('Modal not found:', modalId);
                }
            } catch (error) {
                console.error('Close modal error:', error);
            }
        }

        function startChallenge(type) {
            console.log('Starting challenge:', type);
            try {
                closeModal('challengeModal');

                const challengeMessages = {
                    memory: "üß† Memory Challenge Started! Focus and remember the pattern!",
                    speed: "‚ö° Speed Challenge Started! React as fast as you can!",
                    logic: "üß© Logic Challenge Started! Use your reasoning skills!"
                };

                showToast(challengeMessages[type] || "üéÆ Challenge Started! Good luck!");

                // Simulate challenge progress
                setTimeout(() => {
                    showToast("‚≠ê Great job! Challenge progress updated!");
                }, 3000);

                console.log('Challenge started successfully:', type);
            } catch (error) {
                console.error('Start challenge error:', error);
                showToast("Error starting challenge");
            }
        }

        function showLeaderboard() {
            console.log('Showing leaderboard...');
            try {
                const modal = document.getElementById('leaderboardModal');
                if (modal) {
                    modal.classList.add('active');
                    showToast("üèÜ Leaderboard loaded!");
                    console.log('Leaderboard modal opened');
                } else {
                    console.error('Leaderboard modal not found');
                    showToast("Error: Leaderboard not available");
                }
            } catch (error) {
                console.error('Leaderboard error:', error);
                showToast("Error showing leaderboard");
            }
        }

        function createConfetti() {
            console.log('Creating confetti...');
            try {
                for (let i = 0; i < 30; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.animationDelay = Math.random() * 3 + 's';
                        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';

                        // Random colors for confetti
                        const colors = ['#FBC4AB', '#A7C7E7', '#B9E0D8', '#EAD7D1', '#FFF5BA'];
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];

                        document.body.appendChild(confetti);

                        setTimeout(() => {
                            if (confetti.parentNode) {
                                confetti.remove();
                            }
                        }, 5000);
                    }, i * 100);
                }
            } catch (error) {
                console.error('Confetti error:', error);
            }
        }

        // ============ SLEEP FUNCTIONS ============
        function trackSleep() {
            console.log('Tracking sleep...');
            try {
                const progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                progressBar.innerHTML = '<div class="progress-fill animated" style="--target-width: 87%; animation: progressFill 5s ease-in-out; width: 87%;"></div>';

                const sleepCard = document.querySelector('#sleep .sleep-score');
                if (sleepCard && sleepCard.parentElement) {
                    sleepCard.parentElement.appendChild(progressBar);
                    showToast("üåô Sleep tracking started...");

                    // Animate score counting up
                    let score = 0;
                    const targetScore = 87;
                    const scoreText = document.getElementById('sleepScoreText');
                    const scoreCircle = document.getElementById('sleepScoreCircle');

                    const interval = setInterval(() => {
                        score += 3;
                        if (score >= targetScore) {
                            score = targetScore;
                            clearInterval(interval);
                        }

                        if (scoreText) {
                            scoreText.textContent = `${score}/100`;
                        }

                        // Update circle progress
                        if (scoreCircle) {
                            const circumference = 408;
                            const offset = circumference - (score / 100) * circumference;
                            scoreCircle.style.strokeDashoffset = offset;
                        }
                    }, 100);

                    setTimeout(() => {
                        if (progressBar.parentNode) {
                            progressBar.remove();
                        }
                        showToast("‚úÖ Sleep analysis complete! Score: " + targetScore + "/100");
                    }, 5000);

                    console.log('Sleep tracking started');
                } else {
                    console.error('Sleep card not found');
                    showToast("Error: Sleep tracking not available");
                }
            } catch (error) {
                console.error('Sleep tracking error:', error);
                showToast("Error tracking sleep");
            }
        }

        function expandSleepTips() {
            console.log('Expanding sleep tips...');
            try {
                const tipsContent = `
                    <h4 style="color: var(--sleep-color); margin-bottom: 1rem;">üí° Personalized Sleep Tips</h4>
                    <div style="background: rgba(0,0,0,0.05); padding: 1.5rem; border-radius: 12px; margin: 1rem 0;">
                        <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
                            <li>üïô Your optimal bedtime is 10:30 PM based on your circadian rhythm</li>
                            <li>ü´Å Try the 4-7-8 breathing technique to fall asleep faster</li>
                            <li>üå°Ô∏è Keep your bedroom temperature between 65-68¬∞F (18-20¬∞C)</li>
                            <li>üì± Avoid screens 1 hour before your target bedtime</li>
                            <li>üßò Consider light stretching or meditation before bed</li>
                            <li>‚òï Avoid caffeine after 2 PM for better sleep quality</li>
                        </ul>
                    </div>
                    <button class="btn btn-sleep" onclick="closeSleepTips(this)" style="margin-top: 1rem;">
                        <i class="fas fa-times"></i>
                        Close Tips
                    </button>
                `;

                if (event && event.target) {
                    event.target.innerHTML = tipsContent;
                    showToast("üí° Sleep tips expanded!");
                }
            } catch (error) {
                console.error('Expand sleep tips error:', error);
                showToast("Error expanding sleep tips");
            }
        }

        function closeSleepTips(button) {
            try {
                if (button && button.parentElement) {
                    button.parentElement.innerHTML = '<div style="cursor: pointer;" onclick="expandSleepTips()"><p><i class="fas fa-lightbulb"></i> Click to view personalized sleep tips</p></div>';
                    showToast("Sleep tips closed");
                }
            } catch (error) {
                console.error('Close sleep tips error:', error);
            }
        }

        function viewSleepHistory() {
            console.log('Viewing sleep history...');
            try {
                const modal = document.getElementById('sleepHistoryModal');
                if (modal) {
                    modal.classList.add('active');
                    showToast("üìä Sleep history loaded!");
                    console.log('Sleep history modal opened');
                } else {
                    console.error('Sleep history modal not found');
                    showToast("Error: Sleep history not available");
                }
            } catch (error) {
                console.error('Sleep history error:', error);
                showToast("Error viewing sleep history");
            }
        }

        // ============ FOCUS FUNCTIONS ============
        function startFocusSession() {
            console.log('Starting focus session...');
            try {
                if (isTimerRunning) {
                    stopFocusSession();
                    return;
                }

                isTimerRunning = true;
                focusTime = 25 * 60; // Reset to 25 minutes

                const button = event.target || document.querySelector('#focus .btn-focus');
                if (button) {
                    button.innerHTML = '<i class="fas fa-pause"></i> Pause Session';
                }

                showToast("üéØ Focus session started! 25 minutes of deep work.");

                focusTimer = setInterval(() => {
                    focusTime--;
                    updateTimerDisplay();

                    if (focusTime <= 0) {
                        stopFocusSession();
                        showToast("üéâ Focus session complete! Great work!");
                        createConfetti();
                    }
                }, 1000);

                console.log('Focus session started');
            } catch (error) {
                console.error('Focus session error:', error);
                showToast("Error starting focus session");
            }
        }

        function stopFocusSession() {
            console.log('Stopping focus session...');
            try {
                isTimerRunning = false;
                if (focusTimer) {
                    clearInterval(focusTimer);
                    focusTimer = null;
                }

                const button = document.querySelector('#focus .btn-focus');
                if (button) {
                    button.innerHTML = '<i class="fas fa-play"></i> Begin Focus Session';
                }

                // Reset timer display
                focusTime = 25 * 60;
                updateTimerDisplay();
                showToast("‚è∏Ô∏è Focus session stopped");
                console.log('Focus session stopped');
            } catch (error) {
                console.error('Stop focus session error:', error);
            }
        }

        function updateTimerDisplay() {
            try {
                const minutes = Math.floor(focusTime / 60);
                const seconds = focusTime % 60;
                const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                const timerText = document.getElementById('timerText');
                if (timerText) {
                    timerText.textContent = display;
                }

                // Update circle progress
                const totalTime = 25 * 60;
                const progress = (totalTime - focusTime) / totalTime;
                const circumference = 565;
                const offset = circumference - (progress * circumference);

                const timerProgress = document.getElementById('timerProgress');
                if (timerProgress) {
                    timerProgress.style.strokeDashoffset = offset;
                }
            } catch (error) {
                console.error('Update timer error:', error);
            }
        }

        function selectFocusMode(mode) {
            console.log('Selecting focus mode:', mode);
            try {
                const modes = {
                    deep: "üî• Deep Work mode activated - 50 minutes of intensive focus",
                    light: "‚ú® Light Focus mode activated - 25 minutes of gentle concentration",
                    relax: "üå∏ Relax mode activated - calm background ambience"
                };

                showToast(modes[mode] || "üéØ Focus mode activated");

                // Update focus time based on mode
                if (mode === 'deep') {
                    focusTime = 50 * 60;
                } else if (mode === 'light') {
                    focusTime = 25 * 60;
                } else {
                    focusTime = 15 * 60;
                }

                updateTimerDisplay();
                console.log('Focus mode selected:', mode);
            } catch (error) {
                console.error('Select focus mode error:', error);
                showToast("Error selecting focus mode");
            }
        }

        function startQuoteRotation() {
            console.log('Starting quote rotation...');
            try {
                // Clear existing interval if any
                if (quoteInterval) {
                    clearInterval(quoteInterval);
                }

                const quotes = [
                    "The successful warrior is the average person with laser-like focus.",
                    "Concentration is the secret of strength.",
                    "The art of being wise is knowing what to overlook.",
                    "Focus on being productive instead of busy.",
                    "Where focus goes, energy flows and results show.",
                    "Single-tasking is the new superpower.",
                    "Attention is the rarest and purest form of generosity."
                ];

                let currentQuote = 0;

                quoteInterval = setInterval(() => {
                    if (activeTab === 'focus') {
                        currentQuote = (currentQuote + 1) % quotes.length;
                        const quoteElement = document.getElementById('motivationalQuote');
                        if (quoteElement) {
                            quoteElement.style.animation = 'none';
                            quoteElement.textContent = quotes[currentQuote];
                            setTimeout(() => {
                                quoteElement.style.animation = 'fadeIn 1s ease';
                            }, 100);
                        }
                    }
                }, 10000);

                console.log('Quote rotation started');
            } catch (error) {
                console.error('Quote rotation error:', error);
            }
        }

        // ============ MAKE ALL FUNCTIONS GLOBALLY ACCESSIBLE ============
        window.navigateToPage = navigateToPage;
        window.startBrainScan = startBrainScan;
        window.showBrainInfo = showBrainInfo;
        window.joinChallenge = joinChallenge;
        window.openChallenge = openChallenge;
        window.startChallenge = startChallenge;
        window.showLeaderboard = showLeaderboard;
        window.trackSleep = trackSleep;
        window.expandSleepTips = expandSleepTips;
        window.closeSleepTips = closeSleepTips;
        window.viewSleepHistory = viewSleepHistory;
        window.startFocusSession = startFocusSession;
        window.stopFocusSession = stopFocusSession;
        window.selectFocusMode = selectFocusMode;
        window.showToast = showToast;
        window.closeModal = closeModal;
        window.createConfetti = createConfetti;
        window.startQuoteRotation = startQuoteRotation;

        // ============ EVENT HANDLERS AND INITIALIZATION ============

        // Close modals when clicking outside
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });

        // Global error handler
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            showToast('‚ö†Ô∏è An error occurred. Please try again.');
        });

        // Gradient move animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes gradientMove {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(100%); }
            }
            @keyframes slideInFromRight {
                from { transform: translateX(100%); }
                to { transform: translateX(0); }
            }
        `;
        document.head.appendChild(style);

        // ============ INITIALIZATION ============
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ NeuroX Initializing...');

            try {
                // Set initial timer display
                updateTimerDisplay();

                // Add fallback event listeners for elements that might not have onclick handlers
                const initializeEventListeners = () => {
                    console.log('Setting up event listeners...');

                    // Navigation tabs (fallback)
                    document.querySelectorAll('.nav-tab').forEach(tab => {
                        if (!tab.onclick) {
                            tab.addEventListener('click', (e) => {
                                const page = tab.getAttribute('data-page');
                                if (page) {
                                    navigateToPage(page);
                                }
                            });
                        }
                    });

                    // Challenge cards (fallback)
                    document.querySelectorAll('.challenge-card').forEach(card => {
                        if (!card.onclick) {
                            card.addEventListener('click', () => {
                                const titleText = card.querySelector('.challenge-title')?.textContent.toLowerCase() || '';
                                let type = 'memory';
                                if (titleText.includes('speed')) type = 'speed';
                                else if (titleText.includes('logic')) type = 'logic';
                                openChallenge(type);
                            });
                        }
                    });

                    // Focus mode cards (fallback)
                    document.querySelectorAll('#focus .card-grid .card').forEach(card => {
                        if (!card.onclick) {
                            card.addEventListener('click', () => {
                                const title = card.querySelector('h4')?.textContent.toLowerCase() || '';
                                if (title.includes('deep')) selectFocusMode('deep');
                                else if (title.includes('light')) selectFocusMode('light');
                                else if (title.includes('relax')) selectFocusMode('relax');
                            });
                        }
                    });

                    console.log('Event listeners set up successfully');
                };

                // Initialize event listeners
                initializeEventListeners();

                // Test all functions to ensure they're accessible
                const testFunctions = () => {
                    console.log('üß™ Testing functions...');
                    const functions = [
                        'navigateToPage', 'startBrainScan', 'joinChallenge', 'openChallenge',
                        'startChallenge', 'showLeaderboard', 'trackSleep', 'expandSleepTips',
                        'viewSleepHistory', 'startFocusSession', 'selectFocusMode', 'showBrainInfo',
                        'closeModal', 'showToast'
                    ];

                    let successCount = 0;
                    functions.forEach(funcName => {
                        if (typeof window[funcName] !== 'function') {
                            console.error(`‚ùå Function ${funcName} is not accessible globally`);
                        } else {
                            console.log(`‚úÖ Function ${funcName} is ready`);
                            successCount++;
                        }
                    });

                    console.log(`üéØ ${successCount}/${functions.length} functions ready`);
                    return successCount === functions.length;
                };

                const allFunctionsReady = testFunctions();

                // Add welcome animations
                setTimeout(() => {
                    const heroTitle = document.querySelector('.hero-title');
                    const heroSubtitle = document.querySelector('.hero-subtitle');
                    if (heroTitle) heroTitle.style.animation = 'fadeInUp 0.8s ease-out';
                    if (heroSubtitle) heroSubtitle.style.animation = 'fadeInUp 0.8s ease-out 0.2s both';
                }, 500);

                // Show initialization complete message
                setTimeout(() => {
                    if (allFunctionsReady) {
                        showToast('üéâ NeuroX ready! All features activated.');
                        console.log('üéâ NeuroX initialization complete - All systems operational!');
                    } else {
                        showToast('‚ö†Ô∏è NeuroX started with some issues. Check console.');
                        console.log('‚ö†Ô∏è NeuroX initialization completed with warnings');
                    }
                }, 1000);

            } catch (error) {
                console.error('‚ùå Initialization error:', error);
                showToast('‚ùå NeuroX initialization failed');
            }
        });

        // Add dynamic background animations
        setInterval(() => {
            try {
                const bg = document.getElementById('animatedBg');
                if (bg) {
                    bg.style.backgroundPosition = `${Math.random() * 100}% ${Math.random() * 100}%`;
                }
            } catch (error) {
                // Silently handle animation errors
            }
        }, 5000);

        // Final function availability check
        setTimeout(() => {
            console.log('üîç Final function check:');
            console.log('navigateToPage:', typeof window.navigateToPage);
            console.log('startBrainScan:', typeof window.startBrainScan);
            console.log('joinChallenge:', typeof window.joinChallenge);
            console.log('openChallenge:', typeof window.openChallenge);
            console.log('trackSleep:', typeof window.trackSleep);
            console.log('startFocusSession:', typeof window.startFocusSession);
        }, 2000);
    </script>
</body>
</html>
